# دليل النشر – الواجهة الأمامية فرسان العقيدة

هذا الدليل يشرح كيفية نشر واجهة موقع **فرسان العقيدة** على خدمات الاستضافة السحابية مثل Vercel أو Netlify وربطها بقاعدة البيانات.

## 1. التحضير

### قاعدة البيانات

نوصي باستخدام **MongoDB Atlas** لقاعدة البيانات. قم بإنشاء Cluster مجاني واحصل على سلسلة الاتصال (Connection String) الخاصة بك، ثم أنشئ قاعدة بيانات وليكن اسمها `foursan_al_aqida`.

### الخادم الخلفي (API)

يعمل هذا التطبيق الأمامي مع خادم خلفي مبني على **FastAPI** (الموجود في مجلد `api/` في مشروعك الأصلي). قبل نشر الواجهة، تأكد من نشر الـAPI، إما على Vercel (كـ Serverless Functions) أو منصة أخرى مثل Render أو Railway.

بعد نشر الخادم الخلفي، احفظ عنوان الـURL الأساسي، مثلاً:

```text
https://foursan-al-aqida-api.vercel.app
```

ستستخدم هذا العنوان لاحقًا في متغير البيئة `VITE_API_BASE_URL` في الواجهة الأمامية.

## 2. النشر على Vercel

1. سجّل الدخول إلى [Vercel](https://vercel.com) وقم بربط حسابك بمستودع GitHub الذي يحتوي على مجلد `frontend`.
2. عند إنشاء مشروع جديد اختر المجلد الفرعي `frontend` كمصدر للبناء.
3. حدّد إعدادات البناء:
   - **Framework Preset**: اختر **Vite**.
   - **Build Command**: `npm run build`
   - **Output Directory**: `dist`
4. أضف متغيرات البيئة:
   - `VITE_API_BASE_URL` = `https://foursan-al-aqida-api.vercel.app`
5. اضغط **Deploy** وانتظر حتى تنتهي عملية النشر.

### تشغيل الخادم الخلفي على Vercel

إذا كنت تستخدم FastAPI كسيرفر بلا خادم، أنشئ ملف `vercel.json` في جذر مجلد الـAPI يحدد المسارات. تأكد من تعريف متغيرات البيئة الخاصة بقاعدة البيانات و`SECRET_KEY`.

## 3. النشر على Netlify

1. سجّل الدخول إلى [Netlify](https://netlify.com) وقم بربط المستودع.
2. عند إعداد الموقع اختر `frontend` كمجلد البناء.
3. أدخل الأمر:

   ```text
   npm run build
   ```

   وحدد مجلد الإخراج `dist`.
4. أضف متغير البيئة `VITE_API_BASE_URL` بنفس الطريقة.

## 4. التحقق بعد النشر

بعد اكتمال النشر، قم بزيارة الموقع للتأكد من تحميل الصفحات بشكل صحيح. جرّب صفحات الأقسام والمقالات وتحقق من أن الاتصالات بالخادم الخلفي تعمل.

## 5. نصائح للأداء

- استخدم صورًا بصيغة **WebP** كلما أمكن لتقليل حجم الملفات.
- فعّل **التحميل الكسول** (lazy loading) للصور الكبيرة، كما هو مستخدم في المكونات داخل هذا المشروع.
- تحقق من حجم الصفحة باستخدام أدوات مثل Lighthouse للتأكد من أن الأداء وإمكانية الوصول تحقق درجات عالية.

## 6. أمان

- تأكد من تشفير كلمات المرور في الخادم الخلفي باستخدام **BCrypt**.
- استخدم **JWT** للمصادقة وتخزين التوكن في الـHTTP Only cookies لزيادة الأمان.
- حدّث متغيرات البيئة الحساسة عبر لوحة Vercel/Netlify ولا تشاركها في المستودع العام.

بحمد الله تمت، نتمنى لكم تجربة نشر ناجحة وموقعًا مفيدًا للعلم الشرعي.